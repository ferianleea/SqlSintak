SELECT 
    A.USRID,
    B.name,
    
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-01%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-01_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-01%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-01_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-02%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-02_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-02%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-02_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-03%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-03_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-03%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-03_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-04%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-04_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-04%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-04_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-05%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-05_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-05%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-05_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-06%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-06_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-06%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-06_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-07%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-07_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-07%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-07_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-08%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-08_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-08%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-08_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-09%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-09_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-09%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-09_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-10%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-10_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-10%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-10_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-11%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-11_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-11%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-11_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-12%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-12_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-12%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-12_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-13%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-13_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-13%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-13_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-14%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-14_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-14%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-14_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-15%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-15_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-15%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-15_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-16%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-16_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-16%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-16_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-17%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-17_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-17%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-17_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-18%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-18_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-18%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-18_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-19%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-19_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-19%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-19_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-20%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-20_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-20%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-20_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-21%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-21_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-21%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-21_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-22%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-22_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-22%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-22_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-23%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-23_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-23%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-23_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-24%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-24_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-24%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-24_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-25%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-25_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-25%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-25_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-26%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-26_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-26%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-26_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-27%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-27_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-27%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-27_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-28%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-28_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-28%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-28_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-29%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-29_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-29%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-29_Pulang],
	MAX(CASE WHEN A.SRVDT LIKE '%2024-03-30%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-30_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-30%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-30_Pulang],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-31%' AND CONVERT(TIME, A.SRVDT) BETWEEN '06:00:00' AND '12:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-31_Masuk],
    MAX(CASE WHEN A.SRVDT LIKE '%2024-03-31%' AND CONVERT(TIME, A.SRVDT) BETWEEN '12:00:01' AND '23:00:00' THEN A.SRVDT ELSE NULL END) AS [2024-03-31_Pulang]
FROM 
    T_LG202403 AS A
INNER JOIN 
    [dbo].[user] AS B ON A.USRID = B.user_id
WHERE 
    B.user_group_name = 'UMUM'
GROUP BY 
    A.USRID, 
    B.name
ORDER BY 
    A.USRID, 
    B.name;
